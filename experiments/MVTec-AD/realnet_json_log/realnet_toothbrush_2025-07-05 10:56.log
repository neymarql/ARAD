[2025-07-05 10:56:44,157][train_realnet.py][line: 122][    INFO] args: Namespace(config='experiments/MVTec-AD/realnet.yaml', dataset='MVTec-AD', local_rank=-1, class_name='toothbrush')
[2025-07-05 10:56:44,159][train_realnet.py][line: 123][    INFO] config: {'checkpoints_path': 'experiments/MVTec-AD/realnet_json_ckpts',
 'criterion': [{'kwargs': {'weight': 1.0},
                'name': 'FeatureMSELoss',
                'type': 'FeatureMSELoss'},
               {'kwargs': {'weight': 1.0},
                'name': 'ImageMSELoss',
                'type': 'ImageMSELoss'},
               {'kwargs': {'alpha': [0.2, 0.8], 'gamma': 2, 'weight': 1.0},
                'name': 'SegmentFocalLoss',
                'type': 'SegmentFocalLoss'}],
 'dataset': {'batch_size': 16,
             'category': 'toothbrush',
             'clip_linear_min': 0.05,
             'clip_softmax_temp': 0.07,
             'clip_w': 'softmax',
             'input_size': [512, 512],
             'json_root': '/home/qianlong/mnt_link/hartad/data/descriptions_qwen2.5_32b_mvtecad',
             'normal_ratio': 0.5,
             'pixel_mean': [0.485, 0.456, 0.406],
             'pixel_std': [0.229, 0.224, 0.225],
             'sample_mode': 'pair',
             'test': {'meta_file': './data/MVTec-AD/samples/test_toothbrush.json'},
             'train': {'hflip': False,
                       'meta_file': 'data/MVTec-AD/samples/train_toothbrush.json',
                       'rotate': False,
                       'vflip': False},
             'type': 'mvtec',
             'workers': 4},
 'exp_path': 'experiments/MVTec-AD',
 'log_path': 'experiments/MVTec-AD/realnet_json_log',
 'net': [{'frozen': True,
          'kwargs': {'backbone': 'wide_resnet50_2',
                     'outlayers': ['layer1', 'layer2', 'layer3', 'layer4']},
          'name': 'backbone',
          'type': 'models.backbones.Backbone'},
         {'frozen': True,
          'kwargs': {'init_bsn': 64,
                     'structure': [{'layers': [{'idx': 'layer1',
                                                'planes': 256}],
                                    'name': 'block1',
                                    'stride': 4},
                                   {'layers': [{'idx': 'layer2',
                                                'planes': 512}],
                                    'name': 'block2',
                                    'stride': 8},
                                   {'layers': [{'idx': 'layer3',
                                                'planes': 512}],
                                    'name': 'block3',
                                    'stride': 16},
                                   {'layers': [{'idx': 'layer4',
                                                'planes': 256}],
                                    'name': 'block4',
                                    'stride': 32}]},
          'name': 'afs',
          'prev': 'backbone',
          'type': 'models.afs.AFS'},
         {'kwargs': {'attention_mult': [2, 4],
                     'channel_mult': [1, 2, 4],
                     'hide_channels_ratio': 0.5,
                     'num_res_blocks': 2},
          'name': 'recon',
          'prev': 'afs',
          'type': 'models.recon.ReconstructionLayer'}],
 'random_seed': 100,
 'saver': {'checkpoints_dir': 'realnet_json_ckpts',
           'log_dir': 'realnet_json_log'},
 'structure': [{'layers': [{'idx': 'layer1', 'planes': 256}],
                'name': 'block1',
                'stride': 4},
               {'layers': [{'idx': 'layer2', 'planes': 512}],
                'name': 'block2',
                'stride': 8},
               {'layers': [{'idx': 'layer3', 'planes': 512}],
                'name': 'block3',
                'stride': 16},
               {'layers': [{'idx': 'layer4', 'planes': 256}],
                'name': 'block4',
                'stride': 32}],
 'trainer': {'max_epoch': 2000,
             'optimizer': {'kwargs': {'lr': 0.0001, 'weight_decay': 0},
                           'type': 'Adam'},
             'print_freq_step': 30,
             'val_freq_epoch': 1},
 'version': 'v1.0.0'}
[2025-07-05 10:56:44,160][train_realnet.py][line: 124][    INFO] class name is : toothbrush
